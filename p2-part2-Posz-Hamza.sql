DROP TABLE atp_megatable;

CREATE TABLE atp_megatable (
ID VARCHAR(3),
Aces_1 VARCHAR(3),
Aces_2 VARCHAR(3),
Aces_A_1 VARCHAR(3),
Aces_A_2 VARCHAR(3),
Aces_L5_1 VARCHAR(3),
Aces_L5_2 VARCHAR(3),
Age_CUR_1 VARCHAR(3),
Age_CUR_2 VARCHAR(3),
BreakPointsConvertedPCT_1 VARCHAR(3),
BreakPointsConvertedPCT_2 VARCHAR(3),
BreakPointsConvertedPCT_A_1 VARCHAR(3),
BreakPointsConvertedPCT_A_2 VARCHAR(3),
BreakPointsConvertedPCT_L5_1 VARCHAR(3),
BreakPointsConvertedPCT_L5_2 VARCHAR(3),
BreakPointsConverted_1 VARCHAR(3),
BreakPointsConverted_2 VARCHAR(3),
BreakPointsConverted_A_1 VARCHAR(3),
BreakPointsConverted_A_2 VARCHAR(3),
BreakPointsConverted_L5_1 VARCHAR(3),
BreakPointsConverted_L5_2 VARCHAR(3),
BreakPointsTotal_1 VARCHAR(3),
BreakPointsTotal_2 VARCHAR(3),
BreakPointsTotal_A_1 VARCHAR(3),
BreakPointsTotal_A_2 VARCHAR(3),
BreakPointsTotal_L5_1 VARCHAR(3),
BreakPointsTotal_L5_2 VARCHAR(3),
DaysFromLast_CUR_1 VARCHAR(3),
DaysFromLast_CUR_2 VARCHAR(3),
DoubleFaults_1 VARCHAR(3),
DoubleFaults_2 VARCHAR(3),
DoubleFaults_A_1 VARCHAR(3),
DoubleFaults_A_2 VARCHAR(3),
DoubleFaults_L5_1 VARCHAR(3),
DoubleFaults_L5_2 VARCHAR(3),
F_1 VARCHAR(3),
F_2 VARCHAR(3),
F_A_1 VARCHAR(3),
F_A_2 VARCHAR(3),
F_CUR_1 VARCHAR(3),
F_CUR_2 VARCHAR(3),
F_L5_1 VARCHAR(3),
F_L5_2 VARCHAR(3),
GRes_1 VARCHAR(3),
GRes_2 VARCHAR(3),
GRes_A_1 VARCHAR(3),
GRes_A_2 VARCHAR(3),
GRes_CUR_1 VARCHAR(3),
GRes_L5_1 VARCHAR(3),
GRes_L5_2 VARCHAR(3),
GameD VARCHAR(3),
HomeChanged_CUR_1 VARCHAR(3),
HomeChanged_CUR_2 VARCHAR(3),
IsBirthDay_CUR_1 VARCHAR(3),
IsBirthDay_CUR_2 VARCHAR(3),
IsHome_1 VARCHAR(3),
IsHome_2 VARCHAR(3),
IsHome_A_1 VARCHAR(3),
IsHome_A_2 VARCHAR(3),
IsHome_CUR_1 VARCHAR(3),
IsHome_CUR_2 VARCHAR(3),
IsHome_L5_1 VARCHAR(3),
IsHome_L5_2 VARCHAR(3),
IsLastRet_CUR_1 VARCHAR(3),
IsLastRet_CUR_2 VARCHAR(3),
K20_CUR_1 VARCHAR(3),
K20_CUR_2 VARCHAR(3),
K21_CUR_1 VARCHAR(3),
K21_CUR_2 VARCHAR(3),
K_1 VARCHAR(3),
K_2 VARCHAR(3),
K_A_1 VARCHAR(3),
K_A_2 VARCHAR(3),
K_CUR_1 VARCHAR(3),
K_CUR_2 VARCHAR(3),
K_L5_1 VARCHAR(3),
K_L5_2 VARCHAR(3),
Month VARCHAR(3),
Name_1 VARCHAR(3),
Name_2 VARCHAR(3),
PS_1 VARCHAR(3),
PS_2 VARCHAR(3),
PS_A_1 VARCHAR(3),
PS_A_2 VARCHAR(3),
PS_CUR_1 VARCHAR(3),
PS_CUR_2 VARCHAR(3),
PS_L5_1 VARCHAR(3),
PS_L5_2 VARCHAR(3),
RID_1 VARCHAR(3),
RID_2 VARCHAR(3),
RID_CUR VARCHAR(3),
ReceivingPointsTotal_1 VARCHAR(3),
ReceivingPointsTotal_2 VARCHAR(3),
ReceivingPointsTotal_A_1 VARCHAR(3),
ReceivingPointsTotal_A_2 VARCHAR(3),
ReceivingPointsTotal_L5_1 VARCHAR(3),
ReceivingPointsTotal_L5_2 VARCHAR(3),
ReceivingPointsWonPCT_1 VARCHAR(3),
ReceivingPointsWonPCT_2 VARCHAR(3),
ReceivingPointsWonPCT_A_1 VARCHAR(3),
ReceivingPointsWonPCT_A_2 VARCHAR(3),
ReceivingPointsWonPCT_L5_1 VARCHAR(3),
ReceivingPointsWonPCT_L5_2 VARCHAR(3),
ReceivingPointsWon_1 VARCHAR(3),
ReceivingPointsWon_2 VARCHAR(3),
ReceivingPointsWon_A_1 VARCHAR(3),
ReceivingPointsWon_A_2 VARCHAR(3),
ReceivingPointsWon_L5_1 VARCHAR(3),
ReceivingPointsWon_L5_2 VARCHAR(3),
Result_CUR_1 VARCHAR(3),
Result_CUR_2 VARCHAR(3),
SETS_0_2_1 VARCHAR(3),
SETS_0_2_2 VARCHAR(3),
SETS_0_2_A_1 VARCHAR(3),
SETS_0_2_A_2 VARCHAR(3),
SETS_0_2_CUR_1 VARCHAR(3),
SETS_0_2_L5_1 VARCHAR(3),
SETS_0_2_L5_2 VARCHAR(3),
SETS_1_2_1 VARCHAR(3),
SETS_1_2_2 VARCHAR(3),
SETS_1_2_A_1 VARCHAR(3),
SETS_1_2_A_2 VARCHAR(3),
SETS_1_2_CUR_1 VARCHAR(3),
SETS_1_2_L5_1 VARCHAR(3),
SETS_1_2_L5_2 VARCHAR(3),
SETS_2_0_1 VARCHAR(3),
SETS_2_0_2 VARCHAR(3),
SETS_2_0_A_1 VARCHAR(3),
SETS_2_0_A_2 VARCHAR(3),
SETS_2_0_CUR_1 VARCHAR(3),
SETS_2_0_L5_1 VARCHAR(3),
SETS_2_0_L5_2 VARCHAR(3),
SETS_2_1_1 VARCHAR(3),
SETS_2_1_2 VARCHAR(3),
SETS_2_1_A_1 VARCHAR(3),
SETS_2_1_A_2 VARCHAR(3),
SETS_2_1_CUR_1 VARCHAR(3),
SETS_2_1_L5_1 VARCHAR(3),
SETS_2_1_L5_2 VARCHAR(3),
Serve1stPCT_1 VARCHAR(3),
Serve1stPCT_2 VARCHAR(3),
Serve1stPCT_A_1 VARCHAR(3),
Serve1stPCT_A_2 VARCHAR(3),
Serve1stPCT_L5_1 VARCHAR(3),
Serve1stPCT_L5_2 VARCHAR(3),
Serve1stWonPCT_1 VARCHAR(3),
Serve1stWonPCT_2 VARCHAR(3),
Serve1stWonPCT_A_1 VARCHAR(3),
Serve1stWonPCT_A_2 VARCHAR(3),
Serve1stWonPCT_L5_1 VARCHAR(3),
Serve1stWonPCT_L5_2 VARCHAR(3),
Serve1stWon_1 VARCHAR(3),
Serve1stWon_2 VARCHAR(3),
Serve1stWon_A_1 VARCHAR(3),
Serve1stWon_A_2 VARCHAR(3),
Serve1stWon_L5_1 VARCHAR(3),
Serve1stWon_L5_2 VARCHAR(3),
Serve1st_1 VARCHAR(3),
Serve1st_2 VARCHAR(3),
Serve1st_A_1 VARCHAR(3),
Serve1st_A_2 VARCHAR(3),
Serve1st_L5_1 VARCHAR(3),
Serve1st_L5_2 VARCHAR(3),
Serve2ndWonPCT_1 VARCHAR(3),
Serve2ndWonPCT_2 VARCHAR(3),
Serve2ndWonPCT_A_1 VARCHAR(3),
Serve2ndWonPCT_A_2 VARCHAR(3),
Serve2ndWonPCT_L5_1 VARCHAR(3),
Serve2ndWonPCT_L5_2 VARCHAR(3),
Serve2ndWon_1 VARCHAR(3),
Serve2ndWon_2 VARCHAR(3),
Serve2ndWon_A_1 VARCHAR(3),
Serve2ndWon_A_2 VARCHAR(3),
Serve2ndWon_L5_1 VARCHAR(3),
Serve2ndWon_L5_2 VARCHAR(3),
ServesTotal_1 VARCHAR(3),
ServesTotal_2 VARCHAR(3),
ServesTotal_A_1 VARCHAR(3),
ServesTotal_A_2 VARCHAR(3),
ServesTotal_L5_1 VARCHAR(3),
ServesTotal_L5_2 VARCHAR(3),
Surface VARCHAR(3),
SurfaceChanged_CUR_1 VARCHAR(3),
SurfaceChanged_CUR_2 VARCHAR(3),
TName VARCHAR(3),
TPoints_1 VARCHAR(3),
TPoints_2 VARCHAR(3),
TPoints_A_1 VARCHAR(3),
TPoints_A_2 VARCHAR(3),
TPoints_CUR_1 VARCHAR(3),
TPoints_CUR_2 VARCHAR(3),
TPoints_L5_1 VARCHAR(3),
TPoints_L5_2 VARCHAR(3),
TTL_1 VARCHAR(3),
TTL_2 VARCHAR(3),
TTL_A_1 VARCHAR(3),
TTL_A_2 VARCHAR(3),
TTL_CUR_1 VARCHAR(3),
TTL_L5_1 VARCHAR(3),
TTL_L5_2 VARCHAR(3),
TotalPointsWon_1 VARCHAR(3),
TotalPointsWon_2 VARCHAR(3),
TotalPointsWon_A_1 VARCHAR(3),
TotalPointsWon_A_2 VARCHAR(3),
TotalPointsWon_L5_1 VARCHAR(3),
TotalPointsWon_L5_2 VARCHAR(3),
TourChanged_CUR_1 VARCHAR(3),
TourChanged_CUR_2 VARCHAR(3),
TourCountry VARCHAR(3),
TourDist_CUR_1 VARCHAR(3),
TourDist_CUR_2 VARCHAR(3),
TourRank VARCHAR(3),
TourRank_1 VARCHAR(3),
TourRank_2 VARCHAR(3),
WeekDay VARCHAR(3),
Year VARCHAR(3));


LOAD DATA LOCAL INFILE 'atp.csv'   
INTO TABLE atp_megatable
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
IGNORE 1 LINES;

SELECT * FROM atp_megatable LIMIT 100;

SELECT * FROM atp_megatable where IsBirthDay_CUR_1 <> '0.0'

or Name_2='David Goffin';



/*
Each row contains data about a tennis match.
A lot of the data is stats about that particular match.
For each match, there is 2 players, 1 game date, a tournament associated with the game.
Name_1, Name_2, GameD _> EverythingElse
*/
select distinct Name_1 from atp_megatable
union
select distinct Name_2 from atp_megatable;

select distinct TName, year from atp_megatable;



# DECOMPOSITION

CREATE TABLE IF NOT EXISTS tennis (
  ID INT ,
  Aces_1 VARCHAR(45) ,
  Aces_2 VARCHAR(45) ,
  Aces_A_1 VARCHAR(45) ,
  Aces_A_2 VARCHAR(45) ,
  Aces_L5_2 VARCHAR(45) ,
  Age_CUR_1 VARCHAR(45) ,
  Age_CUR_2 VARCHAR(45) ,
  IDcol VARCHAR(45) ,
  DaysFromLast_CUR_1 VARCHAR(45) ,
  DaysFromLast_CUR_2 VARCHAR(45) ,
  DoubleFaults_1 VARCHAR(45) ,
  DoubleFaults_2 VARCHAR(45) ,
  DoubleFaults_A_1 VARCHAR(45) ,
  DoubleFaults_A_2 VARCHAR(45) ,
  DoubleFaults_L5_1 VARCHAR(45) ,
  DoubleFaults_L5_2 VARCHAR(45) ,
  F_1 VARCHAR(45) ,
  F_2 VARCHAR(45) ,
  F_A_1 VARCHAR(45) ,
  F_A_2 VARCHAR(45) ,
  F_CUR_1 VARCHAR(45) ,
  F_CUR_2 VARCHAR(45) ,
  F_L5_1 VARCHAR(45) ,
  F_L5_2 VARCHAR(45) ,
  GRes_A_1 VARCHAR(45) ,
  GRes_L5_1 VARCHAR(45) ,
  HomeChanged_CUR_1 VARCHAR(45) ,
  HomeChanged_CUR_2 VARCHAR(45) ,
  IsHome_A_1 VARCHAR(45) ,
  IsHome_A_2 VARCHAR(45) ,
  IsHome_L5_1 VARCHAR(45) ,
  IsHome_L5_2 VARCHAR(45) ,
  IsLastRet_CUR_1 VARCHAR(45) ,
  IsLastRet_CUR_2 VARCHAR(45) ,
  K20_CUR_1 VARCHAR(45) ,
  K20_CUR_2 VARCHAR(45) ,
  K21_CUR_1 VARCHAR(45) ,
  K21_CUR_2 VARCHAR(45) ,
  K_1 VARCHAR(45) ,
  K_2 VARCHAR(45) ,
  K_A_1 VARCHAR(45) ,
  K_A_2 VARCHAR(45) ,
  K_CUR_1 VARCHAR(45) ,
  K_CUR_2 VARCHAR(45) ,
  K_L5_1 VARCHAR(45) ,
  K_L5_2 VARCHAR(45) ,
  Name_1 VARCHAR(45) ,
  Name_2 VARCHAR(45) ,
  PS_1 VARCHAR(45) ,
  PS_2 VARCHAR(45) ,
  PS_A_1 VARCHAR(45) ,
  PS_A_2 VARCHAR(45) ,
  PS_CUR_2 VARCHAR(45) ,
  PS_L5_1 VARCHAR(45) ,
  PS_L5_2 VARCHAR(45) ,
  RID_1 VARCHAR(45) ,
  RID_2 VARCHAR(45) ,
  RID_CUR VARCHAR(45) ,
  Serve2ndWon_1 VARCHAR(45) ,
  Serve2ndWon_2 VARCHAR(45) ,
  Serve2ndWon_A_1 VARCHAR(45) ,
  Serve2ndWon_A_2 VARCHAR(45) ,
  Serve2ndWon_L5_1 VARCHAR(45) ,
  Serve2ndWon_L5_2 VARCHAR(45) ,
  Surface VARCHAR(45) ,
  SurfaceChanged_CUR_1 VARCHAR(45) ,
  SurfaceChanged_CUR_2 VARCHAR(45) ,
  TPoints_1 VARCHAR(45) ,
  TPoints_2 VARCHAR(45) ,
  TPoints_A_1 VARCHAR(45) ,
  TPoints_A_2 VARCHAR(45) ,
  TPoints_CUR_1 VARCHAR(45) ,
  TPoints_CUR_2 VARCHAR(45) ,
  TPoints_L5_1 VARCHAR(45) ,
  TPoints_L5_2 VARCHAR(45) ,
  TTL_1 VARCHAR(45) ,
  TTL_2 VARCHAR(45) ,
  TTL_A_1 VARCHAR(45) ,
  TTL_A_2 VARCHAR(45) ,
  TTL_L5_1 VARCHAR(45) ,
  TTL_L5_2 VARCHAR(45) ,
  TotalPointsWon_1 VARCHAR(45) ,
  TotalPointsWon_2 VARCHAR(45) ,
  TotalPointsWon_A_1 VARCHAR(45) ,
  TotalPointsWon_A_2 VARCHAR(45) ,
  TotalPointsWon_L5_1 VARCHAR(45) ,
  TotalPointsWon_L5_2 VARCHAR(45) ,
  TourChanged_CUR_1 VARCHAR(45) ,
  TourChanged_CUR_2 VARCHAR(45) ,
  TourDist_CUR_1 VARCHAR(45) ,
  TourDist_CUR_2 VARCHAR(45) ,
  TourRank_1 VARCHAR(45) ,
  TourRank_2 VARCHAR(45) ,
  PRIMARY KEY (ID));

CREATE TABLE IF NOT EXISTS GameD (
  idGameD INT ,
  Month VARCHAR(45) ,
  WeekDay VARCHAR(45) ,
  Year VARCHAR(45), 
  PRIMARY KEY (idGameD));

CREATE TABLE IF NOT EXISTS result_cur(
  idResult_CUR_1 INT ,
  PS_CUR_1 VARCHAR(45) ,
  Result_CUR_2 VARCHAR(45) ,
  SETS_0_2_CUR_1 VARCHAR(45) ,
  SETS_1_2_CUR_1 VARCHAR(45) ,
  SETS_2_0_CUR_1 VARCHAR(45) ,
  SETS_2_1_CUR_1 VARCHAR(45) ,
  TTL_CUR_1 VARCHAR(45) ,
  GRes_CUR_1 VARCHAR(45) ,
  ID_idID INT ,
  PRIMARY KEY (idResult_CUR_1));


CREATE TABLE IF NOT EXISTS Tournament (
  idTName INT ,
  TourCountry VARCHAR(45) ,
  TourRank VARCHAR(45),
  PRIMARY KEY (idTName));


CREATE TABLE IF NOT EXISTS IsHome_CUR_1 (
  IsHome_CUR_1 INT ,
  IsHome_1 VARCHAR(45) ,
  HomeChanged_CUR_1 VARCHAR(45),
  PRIMARY KEY (IsHome_CUR_1, IsHome_1));


CREATE TABLE IF NOT EXISTS IsHome_CUR_2 (
  idIsHome_CUR_2 INT ,
  IsHome_2 VARCHAR(45) ,
  HomeChanged_CUR_2 VARCHAR(45),
  PRIMARY KEY (idIsHome_CUR_2, IsHome_2));


CREATE TABLE IF NOT EXISTS SETS_1(
  SETS_0_2_1 INT ,
  SETS_1_2_1 VARCHAR(45) ,
  SETS_2_0_1 VARCHAR(45) ,
  SETS_2_1_1 VARCHAR(45) ,
  GRes_1 VARCHAR(45),
  PRIMARY KEY (SETS_0_2_1, SETS_1_2_1, SETS_2_0_1));


CREATE TABLE IF NOT EXISTS SETS_2 (
  SETS_0_2_2 INT ,
  SETS_1_2_2 VARCHAR(45) ,
  SETS_2_0_2 VARCHAR(45) ,
  SETS_2_1_2 VARCHAR(45) ,
  GRes_2 VARCHAR(45),
  PRIMARY KEY (SETS_0_2_2, SETS_1_2_2, SETS_2_0_2));


CREATE TABLE IF NOT EXISTS SETS_2_Last_5 (
  SETS_0_2_L5_2 INT ,
  SETS_1_2_L5_2 VARCHAR(45) ,
  SETS_2_0_L5_2 VARCHAR(45) ,
  SETS_2_1_L5_2 VARCHAR(45) ,
  GRes_L5_2 VARCHAR(45),
  PRIMARY KEY (SETS_0_2_L5_2, SETS_1_2_L5_2, SETS_2_0_L5_2));


CREATE TABLE IF NOT EXISTS SETS_2_overall (
  SETS_0_2_A_2 INT ,
  SETS_1_2_A_2 VARCHAR(45) ,
  SETS_2_0_A_2 VARCHAR(45) ,
  SETS_2_1_A_2 VARCHAR(45) ,
  GRes_A_2 VARCHAR(45) ,
  PRIMARY KEY (SETS_0_2_A_2, SETS_1_2_A_2, SETS_2_0_A_2));


CREATE TABLE IF NOT EXISTS ReceivingPointsTotal_1 (
  ReceivingPointsTotal_1 INT ,
  ReceivingPointsWon_1 VARCHAR(45) ,
  ReceivingPointsWonPCT_1 VARCHAR(45) ,
  PRIMARY KEY (ReceivingPointsTotal_1, ReceivingPointsWon_1));


CREATE TABLE IF NOT EXISTS ReceivingPointsTotal_2 (
  ReceivingPointsTotal_2 INT ,
  ReceivingPointsWon_2 VARCHAR(45) ,
  ReceivingPointsWonPCT_2 VARCHAR(45),
  PRIMARY KEY (ReceivingPointsTotal_2, ReceivingPointsWon_2));


CREATE TABLE IF NOT EXISTS ReceivingPointsTotal_overall_1 (
  ReceivingPointsTotal_A_1 INT ,
  ReceivingPointsWon_A_1 VARCHAR(45) ,
  ReceivingPointsWonPCT_A_1 VARCHAR(45),
  PRIMARY KEY (ReceivingPointsTotal_A_1, ReceivingPointsWon_A_1));


CREATE TABLE IF NOT EXISTS ReceivingPointsTotal_overall_2 (
  idReceivingPointsTotal_A_2 INT ,
  ReceivingPointsWon_A_2 VARCHAR(45) ,
  ReceivingPointsWonPCT_A_2 VARCHAR(45),
  PRIMARY KEY (idReceivingPointsTotal_A_2, ReceivingPointsWon_A_2));


CREATE TABLE IF NOT EXISTS ReceivingPointsTotal_1_last5 (
  ReceivingPointsTotal_L5_1 INT ,
  ReceivingPointsWon_L5_1 VARCHAR(45) ,
  ReceivingPointsWonPCT_L5_1 VARCHAR(45),
  PRIMARY KEY (ReceivingPointsTotal_L5_1, ReceivingPointsWon_L5_1));


CREATE TABLE IF NOT EXISTS ReceivingPointsTotal_2_last (
  ReceivingPointsTotal_L5_2 INT ,
  ReceivingPointsWonPCT_L5_2 VARCHAR(45) ,
  ReceivingPointsWon_L5_2 VARCHAR(45),
  PRIMARY KEY (ReceivingPointsTotal_L5_2, ReceivingPointsWonPCT_L5_2));


CREATE TABLE IF NOT EXISTS ServesTotal_1 (
  ServesTotal_1 INT ,
  Serve1st_1 VARCHAR(45) ,
  Serve1stPCT_1 VARCHAR(45),
  PRIMARY KEY (ServesTotal_1, Serve1st_1));


CREATE TABLE IF NOT EXISTS ServesTotal_2 (
  ServesTotal_2 INT ,
  Serve1st_2 VARCHAR(45) ,
  Serve1stPCT_2 VARCHAR(45),
  PRIMARY KEY (ServesTotal_2, Serve1st_2));


CREATE TABLE IF NOT EXISTS ServesTotal_A_1 (
  ServesTotal_A_1 INT ,
  Serve1st_A_1 VARCHAR(45) ,
  Serve1stPCT_A_1 VARCHAR(45) ,
  PRIMARY KEY (ServesTotal_A_1, Serve1st_A_1));


CREATE TABLE IF NOT EXISTS ServesTotal_A_2 (
  ServesTotal_A_2 INT ,
  Serve1st_A_2 VARCHAR(45) ,
  Serve1stPCT_A_2 VARCHAR(45),
  PRIMARY KEY (ServesTotal_A_2, Serve1st_A_2));


CREATE TABLE IF NOT EXISTS ServesTotal_L5_1 (
  ServesTotal_L5_1 INT ,
  Serve1st_L5_1 VARCHAR(45) ,
  Serve1stPCT_L5_1 VARCHAR(45),
  PRIMARY KEY (ServesTotal_L5_1, Serve1st_L5_1));


CREATE TABLE IF NOT EXISTS ServesTotal_L5_2 (
  ServesTotal_L5_2 INT ,
  Serve1st_L5_2 VARCHAR(45) ,
  Serve1stPCT_L5_2 VARCHAR(45),
  PRIMARY KEY (ServesTotal_L5_2, Serve1st_L5_2));


CREATE TABLE IF NOT EXISTS Serve1st_1 (
  Serve1st_1 INT ,
  Serve1stWon_1 VARCHAR(45) ,
  Serve1stWonPCT_1 VARCHAR(45) ,
  PRIMARY KEY (Serve1st_1, Serve1stWon_1));


CREATE TABLE IF NOT EXISTS Serve1st_2 (
  Serve1st_2 INT ,
  Serve1stWon_2 VARCHAR(45) ,
  Serve1stWonPCT_2 VARCHAR(45),
  PRIMARY KEY (Serve1st_2, Serve1stWon_2));


CREATE TABLE IF NOT EXISTS Serve1st_A_1 (
  Serve1st_A_1 INT ,
  Serve1stWon_A_1 VARCHAR(45) ,
  Serve1stWonPCT_A_1 VARCHAR(45),
  PRIMARY KEY (Serve1st_A_1, Serve1stWon_A_1));


CREATE TABLE IF NOT EXISTS Serve1st_A_2 (
  Serve1st_A_2 INT ,
  Serve1stWon_A_2 VARCHAR(45) ,
  Serve1stWonPCT_A_2 VARCHAR(45),
  PRIMARY KEY (Serve1st_A_2, Serve1stWon_A_2));


CREATE TABLE IF NOT EXISTS Serve1st_L5_1 (
  Serve1st_L5_1 INT ,
  Serve1stWon_L5_1 VARCHAR(45) ,
  Serve1stWonPCT_L5_1 VARCHAR(45),
  PRIMARY KEY (Serve1st_L5_1, Serve1stWon_L5_1));


CREATE TABLE IF NOT EXISTS Serve1st_L5_2 (
  Serve1st_L5_2 INT ,
  Serve1stWon_L5_2 VARCHAR(45) ,
  Serve1stWonPCT_L5_2 VARCHAR(45) ,
  PRIMARY KEY (Serve1st_L5_2, Serve1stWon_L5_2));


CREATE TABLE IF NOT EXISTS BreakPointsTotal_1 (
  BreakPointsTotal_1 INT ,
  BreakPointsConverted_1 VARCHAR(45) ,
  BreakPointsConvertedPCT_1 VARCHAR(45),
  PRIMARY KEY (BreakPointsTotal_1, BreakPointsConverted_1));


CREATE TABLE IF NOT EXISTS BreakPointsTotal_2 (
  BreakPointsTotal_2 INT ,
  BreakPointsConverted_2 VARCHAR(45) ,
  BreakPointsConvertedPCT_2 VARCHAR(45) ,
  PRIMARY KEY (BreakPointsTotal_2, BreakPointsConverted_2));


CREATE TABLE IF NOT EXISTS BreakPointsTotal_A_1 (
  BreakPointsTotal_A_1 INT ,
  BreakPointsConverted_A_1 VARCHAR(45) ,
  BreakPointsConvertedPCT_A_1 VARCHAR(45) ,
  PRIMARY KEY (BreakPointsTotal_A_1, BreakPointsConverted_A_1));


CREATE TABLE IF NOT EXISTS BreakPointsTotal_A_2 (
  BreakPointsTotal_A_2 INT ,
  BreakPointsConverted_A_2 VARCHAR(45) ,
  BreakPointsConvertedPCT_A_2 VARCHAR(45) ,
  PRIMARY KEY (BreakPointsTotal_A_2, BreakPointsConverted_A_2));


CREATE TABLE IF NOT EXISTS BreakPointsTotal_L5_1 (
  BreakPointsTotal_L5_1 INT ,
  BreakPointsConverted_L5_1 VARCHAR(45) ,
  BreakPointsConvertedPCT_L5_1 VARCHAR(45) ,
  PRIMARY KEY (BreakPointsTotal_L5_1, BreakPointsConverted_L5_1));


CREATE TABLE IF NOT EXISTS BreakPointsTotal_L5_2 (
  BreakPointsTotal_L5_2 INT ,
  BreakPointsConverted_L5_2 VARCHAR(45) ,
  BreakPointsConvertedPCT_L5_2 VARCHAR(45) ,
  PRIMARY KEY (BreakPointsTotal_L5_2, BreakPointsConverted_L5_2));
    
-- __ VIEWS

DROP VIEW IF EXISTS pct_points_received;
CREATE VIEW pct_points_received
AS 
SELECT 
    Aces_1, 
    TourRank_1, 
    ReceivingPointsWonPCT_1
FROM tennis
INNER JOIN
    receivingpointstotal_1 USING (ReceivingPointsTotal_1, ReceivingPointsWon_1);



-- __  Trigger

drop trigger if exists aces_before_update; 

delimiter //

CREATE trigger aces_before_update
before update 
on tennis 
for each row 

begin
    declare msg varchar(128);
    if new.Aces_1 < 0 then 
        set msg = concat('Aces can not be negative');
        signal sqlstate '45000' set message_text = msg;
	elseif new.Aces_1 % 1 != 0 then
	set msg = concat('Aces can only be integers.');
	else UPDATE tennis set old.Aces_1 = new.Aces_1 ;
    end if;

end //

-- test trigger
delimiter ;

UPDATE tennis 
set Aces_1 = -1
where Age_CUR_1 > 50 
